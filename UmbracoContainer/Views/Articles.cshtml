@using Umbraco.Cms.Web.Common.PublishedModels
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<Articles>
@{
    Layout = "Master.cshtml";
}

<!-- Main container -->
<div class="container">

    <!-- Featured articlepost -->
    <div class="row section">
        <div class="col-md-12">
            @{
                IPublishedContent featureStory = Model.Value<IPublishedContent>("featureStory");
                if (featureStory != null)
                {
                    <a href="@featureStory.Url()" class="featured-link">
                        <div class="featured-article">
                            @{
                                var featureImage = featureStory.Value<IPublishedContent>("thumbnailImage");
                            }
                            <div class="image-box" style="background-image:url('@featureImage.Url()')"></div>
                            <h2>@featureStory,Value("titleText")</h2>
                            <p>
                                THESE
                                @{
                                    int maxLength = 200;
                                    string articleBody = featureStory.Value("articleText").ToString();
                                    if (articleBody.Length > 200)
                                    {
                                        articleBody.Substring(0, 200);
                                    }
                                    else
                                    {
                                        featureStory.Value("articleText");
                                    }
                                }...
                            </p>
                            <a href="@featureStory.Url()" class="btn btn-primary">Read more </a>
                        </div>
                    </a>
                }
            }
        </div>
    </div>

    <!-- Latest article posts -->
    <div class="row section">
        <div class="col-md-12">
            <h3>Latest stories</h3>
        </div>
    </div>

@{
	var selection = Umbraco.AssignedContentItem.ChildrenOfType("article")
    .Where(x => x.IsVisible());
}
    <!-- Article Post Query goes here. -->
    <div class="row">
        @{
            var selected = selection.\ as IEnumerable<Article>;
            selection = selected.OrderBy<Article, DateTime>(x => x.PublishedOn);
        }
        @foreach (Article item in selection)
        {
            <div class="col-md-4">
                <a href="@item.Url()">
                    <div class="thumbnail-article">
                        @if (item.ThumbnailImage != null) {
                            <div><img src="@(item.ThumbnailImage.Url())" width="150px" /></div>
                        }
                        <h4>@item.ArticleTitle</h4>
                        <h4>@item.Author</h4>
                    </div>
                </a>
            </div>
        }
    </div>
</div>
